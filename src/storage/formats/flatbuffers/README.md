# Flatbuffers RevObject serialization format

This module implements a `RevObjectSerializer` and `RevObjectFactory` using Flatbuffers generated classes.

[Flatbuffers](https://google.github.io/flatbuffers) is an efficient cross platform serialization library for C++, C#, C, Go, Java, JavaScript, Lobster, Lua, TypeScript, PHP, Python, and Rust. It was originally created at Google for game development and other performance-critical applications.

Flatbuffers performance is far superior and memory footprint is considerably lower than other object serialization/deserialization libraries such as Protocol Buffers, and is ideal to hold the state of `RevObject`s (i.e. `RevCommit`, `RevTree`, etc.) instances, because both models are immutable, and flatbuffers stores state in plain array sequences (either `byte[]` or `ByteBuffer`). This means there's practically no parsing overhead, and memory footprint is considerably lower than when building a full Java object graph. Also, when using `FlatBuffersRevObjectFactory` as geogig's default `RevObjectFactory` implementation, and the backend storage also produces flatbuffers `RevObject` instances, there's no overhead in parsing nor serializing in and out of the storage backend or to external streams.

## Building

The `flatc` compiler generates .java files from `.fbs` DSL schemas. See the [generate-sources.sh](generate-sources.sh) file to check how it's invoked.

This java files generation is not part of the standard geogig build process, but it's manually invoked only when needed, and the generated files are part of the build, residing in `src/main/generated-sources` (as opposed to the usual `target/generated-sources` when files are generated by a preprocessor).

If needed, check the [Flatbuffers build guide](https://google.github.io/flatbuffers/flatbuffers_guide_building.html) in order to build the `flatc` executable.

The current generated java classes in the `org.locationtech.geogig.flatbuffers.generated.v1` package were created with `flatc 1.9.0`.
