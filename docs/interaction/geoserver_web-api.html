<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1">
  
  <title>Web-API and GeoServer REST configuration &mdash; GeoGig 1.0-RC2 User Manual</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,800italic,300,700,600,800,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cantarell:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../_static/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />
  <!--[if IE]>
  <link rel="stylesheet" href="../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
   <link rel="stylesheet" href="../_static/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/offcanvas.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0-RC2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
      <link rel="top" title="GeoGig 1.0-RC2 User Manual" href="../index.html" />
      <link rel="up" title="Other ways to interact with GeoGig" href="index.html" />
      <link rel="next" title="Using GeoGig with OpenStreetMap data" href="osm.html" />
      <link rel="prev" title="GeoServer" href="geoserver_ui.html" />
</head>
<body class="interaction/geoserver_web-api">
    <div id="blacktop"></div>
    <header id="masthead">
      <div class="navbar">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://geogig.org"><h1>GeoGig</h1></a>
          </div>
          <div class="navbar-collapse collapse navbar-right">
            <ul class="nav navbar-nav">
              <li><a href="http://geogig.org/#install">Get Started</a></li>
              <li><a href="http://geogig.org/docs/index.html">Documentation</a></li>
              <li><a href="https://github.com/locationtech/geogig">On Github</a></li>
            </ul>
          </div><!--/.navbar-collapse -->
        </div>
      </div>
    </header>

    <section class="subheading hidden-xs">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <p class="byline">A Tool for Geospatial Data Management</p>
          </div>
        </div>
      </div>
    </section>
    <a name="top"></a>

 <div id="main">
    <div class="wrap selfclear">
      <div id="content">
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-right">
          <div class="col-md-8">
            <div class="row pull-right">
             <div class="visible-sm visible-xs" id="menu-btn">
                <button class="btn btn-blue btn-sm"type="button" data-toggle="offcanvas">
                  <span class="btn-text active">Menu &rarr;</span>
                  <span class="btn-back">&larr; Back</span>
                </button>
              </div>
            </div>
<ul id="breadcrumbs">
  
  <li><a href="../index.html">GeoGig 1.0-RC2 User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Other ways to interact with GeoGig</a> &raquo;</li>
  <li>Web-API and GeoServer REST configuration</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../genindex.html" title="General Index"
       accesskey="I">index</a></li>
  <li>
    <a href="osm.html" title="Using GeoGig with OpenStreetMap data"
       accesskey="N">next</a>|</li>
  <li>
    <a href="geoserver_ui.html" title="GeoServer"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="web-api-and-geoserver-rest-configuration">
<h1>Web-API and GeoServer REST configuration<a class="headerlink" href="#web-api-and-geoserver-rest-configuration" title="Permalink to this headline">¶</a></h1>
<p>GeoGig integrates well with the standard GeoServer REST configuration API in order to configure
vector data stores and layers from GeoGig repositories.</p>
<p>You can use a combination of GeoGig&#8217;s own &#8220;Web API&#8221; and GeoServer&#8217;s REST configuration API to
create a wide variety of scripts.</p>
<div class="section" id="geogig-s-plugin-web-api">
<h2>GeoGig&#8217;s plugin Web-API<a class="headerlink" href="#geogig-s-plugin-web-api" title="Permalink to this headline">¶</a></h2>
<p>With the GeoGig GeoServer plug-in, unlike than with the <tt class="docutils literal"><span class="pre">geogig</span> <span class="pre">serve</span></tt> command, it is possible to expose
several repositories. To do so, the GeoGig plug-in installs REST entry points under the <tt class="docutils literal"><span class="pre">&lt;geoserver</span> <span class="pre">context&gt;/geogig</span></tt>
context (e.g. <tt class="docutils literal"><span class="pre">http://localhost:8080/geoserver/geogig</span></tt>).</p>
<p>That root context can be used to query which repositories are being served by GeoServer.</p>
<p>GeoSever managed repositories are uniquely identified by a UUID automatically assigned when the repository is first added
to the GeoServer configuration.</p>
<p>Each specific repository&#8217;s Web-API is accessed through the <tt class="docutils literal"><span class="pre">&lt;geosever</span> <span class="pre">context&gt;/geogig/&lt;repository</span> <span class="pre">id&gt;</span></tt> entry point, at
a difference to the <tt class="docutils literal"><span class="pre">geogig</span> <span class="pre">serve</span></tt> command that exposes the repository at the root application context.</p>
<p>So, for example, whenever you would list the current HEAD&#8217;s commits by querying <tt class="docutils literal"><span class="pre">http://localhost:8182/log</span></tt> if serving
a single repository with <tt class="docutils literal"><span class="pre">geogig</span> <span class="pre">serve</span></tt>, the same command as served by GeoServer would be at <tt class="docutils literal"><span class="pre">http://localhost:8080/geoserver/geogig/&lt;repository</span> <span class="pre">id&gt;/log</span></tt>.</p>
<p>From that point on, the commands available are exactly the same then when using the standalone Web API.</p>
</div>
<div class="section" id="creating-a-geogig-datastore-with-rest">
<h2>Creating a GeoGig DataStore with REST<a class="headerlink" href="#creating-a-geogig-datastore-with-rest" title="Permalink to this headline">¶</a></h2>
<p>To create a GeoGig DataStore through the GeoServer REST API, you just need to follow the
<a class="reference external" href="http://docs.geoserver.org/stable/en/user/rest/api/datastores.html">standard procedure</a>,
knowing which data store connection parameters to use.</p>
<p>That is, issuing a <tt class="docutils literal"><span class="pre">POST</span></tt> request to <tt class="docutils literal"><span class="pre">/workspaces/&lt;ws&gt;/datastores[.&lt;format&gt;]</span></tt>, where the request body for the XML
representation is like:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;dataStore&gt;
   &lt;name&gt;${data store name}&lt;/name&gt;
   &lt;connectionParameters&gt;
      &lt;entry key=&quot;geogig_repository&quot;&gt;${repository directory}&lt;/entry&gt;
      &lt;entry key=&quot;branch&quot;&gt;${branch}&lt;/entry&gt;
   &lt;/connectionParameters&gt;
&lt;/dataStore&gt;
</pre></div>
</div>
<p>That&#8217;s all the information needed to create a GeoGig data store.</p>
<ul class="simple">
<li>${data store name} is the name to be given to the data store, which then will be accessible through <tt class="docutils literal"><span class="pre">/workspaces/&lt;ws&gt;/datastores/&lt;data</span> <span class="pre">store</span> <span class="pre">name&gt;</span></tt>.</li>
<li>${repository directory} is the full path to the repository in the server file system.</li>
<li>${branch} is optional, and represents the name of the branch the data store is going to serve its data from. If not given, defaults to using</li>
</ul>
<p>whatever branch is the currently checked out one in the repository whenever the data store is used.</p>
</div>
<div class="section" id="quick-example">
<h2>Quick example:<a class="headerlink" href="#quick-example" title="Permalink to this headline">¶</a></h2>
<p>For the impatient, here&#8217;s a very quick cheat sheet on how to create a datastore and layer for a repository.
Suppose you have a repository created at <tt class="docutils literal"><span class="pre">/data/myrepo</span></tt> in the file system and it contains a <tt class="docutils literal"><span class="pre">roads</span></tt> feature type tree, and GeoServer
has a workspace named <tt class="docutils literal"><span class="pre">ws1</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -d &quot;&lt;dataStore&gt;&lt;name&gt;my_geogig_repo&lt;/name&gt;&lt;connectionParameters&gt;&lt;entry key=\&quot;geogig_repository\&quot;&gt;/data/my_repo&lt;/entry&gt;&lt;/connectionParameters&gt;&lt;/dataStore&gt;&quot; http://localhost:8080/geoserver/rest/workspaces/ws1/datastores
&lt; HTTP/1.1 201 Created
$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -d &quot;&lt;featureType&gt;&lt;name&gt;roads&lt;/name&gt;&lt;/featureType&gt;&quot; http://localhost:8080/geoserver/rest/workspaces/ws1/datastores/my_geogig_repo/featuretypes
&lt; HTTP/1.1 201 Created
</pre></div>
</div>
<p>For a more thorough example take a look at the tutorial bellow.</p>
</div>
<div class="section" id="curl-tutorial">
<h2>cURL tutorial<a class="headerlink" href="#curl-tutorial" title="Permalink to this headline">¶</a></h2>
<p>The following is a small tutorial on how to use a combination of GeoGig and GeoServer web API&#8217;s to configure data stores and layers
from a GeoGig repositories.</p>
<p>Lets start by listing the available repositories, given there are none yet added to geoserver:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -H &quot;Accept:text/xml&quot; &quot;http://localhost:8080/geoserver/geogig&quot;
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;
&lt;repositories/&gt;
</pre></div>
</div>
<p>Got an empty list of repositories. Now lets create an empty repository somewhere in the file system:</p>
<div class="highlight-python"><div class="highlight"><pre>$ mkdir -p /data/repos/geoserver &amp;&amp; cd /data/repos/geoserver
$ geogig init rosario_osm
Initialized empty Geogig repository in /data/repos/geoserver/rosario_osm/.geogig
$ cd rosario_osm
$ geogig config user.name &quot;John Doe&quot;
$ geogig config user.email &quot;John@example.com&quot;
</pre></div>
</div>
<p>Note you can omit the <tt class="docutils literal"><span class="pre">geogig</span> <span class="pre">config</span></tt> commands above if you already have done so with the <tt class="docutils literal"><span class="pre">--global</span></tt> switch. We&#8217;re configuring
it here in the local repository configuration just the sake of demonstration. Either way, both user.name and user.email must be configured
either locally or globally before you can perform any commit.</p>
<p>Now import some OpenStreetMap data and create an <tt class="docutils literal"><span class="pre">osm_roads</span></tt> and an <tt class="docutils literal"><span class="pre">osm_buildings</span></tt> feature type tree in the geogig repository
from the raw <tt class="docutils literal"><span class="pre">node</span></tt> and <tt class="docutils literal"><span class="pre">way</span></tt> OSM data. To do so, create a file named <tt class="docutils literal"><span class="pre">mappings.json</span></tt> with the following contents in the
repository directory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;rules&quot;</span><span class="p">:</span>
  <span class="p">[</span>
    <span class="p">{</span>
      <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;osm_roads&quot;</span><span class="p">,</span>
      <span class="s">&quot;filter&quot;</span><span class="p">:{</span>
         <span class="s">&quot;highway&quot;</span><span class="p">:[</span>
           <span class="s">&quot;tertiary&quot;</span><span class="p">,</span><span class="s">&quot;residential&quot;</span><span class="p">,</span><span class="s">&quot;service&quot;</span><span class="p">,</span><span class="s">&quot;secondary&quot;</span><span class="p">,</span><span class="s">&quot;track&quot;</span><span class="p">,</span><span class="s">&quot;footway&quot;</span><span class="p">,</span><span class="s">&quot;path&quot;</span><span class="p">,</span><span class="s">&quot;unclassified&quot;</span><span class="p">,</span><span class="s">&quot;primary&quot;</span><span class="p">,</span>
           <span class="s">&quot;trunk&quot;</span><span class="p">,</span><span class="s">&quot;motorway&quot;</span><span class="p">,</span><span class="s">&quot;construction&quot;</span><span class="p">,</span><span class="s">&quot;proposed&quot;</span><span class="p">,</span><span class="s">&quot;cycleway&quot;</span><span class="p">,</span><span class="s">&quot;living_street&quot;</span><span class="p">,</span><span class="s">&quot;steps&quot;</span><span class="p">,</span> <span class="s">&quot;road&quot;</span><span class="p">,</span> <span class="s">&quot;pedestrian&quot;</span><span class="p">,</span>
           <span class="s">&quot;construction&quot;</span><span class="p">,</span><span class="s">&quot;bridleway&quot;</span><span class="p">,</span><span class="s">&quot;platform&quot;</span><span class="p">,</span><span class="s">&quot;proposed&quot;</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="s">&quot;fields&quot;</span><span class="p">:{</span>
        <span class="s">&quot;geom&quot;</span><span class="p">:{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;geom&quot;</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;LINESTRING&quot;</span><span class="p">},</span>
        <span class="s">&quot;name&quot;</span><span class="p">:{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;STRING&quot;</span><span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;osm_buildings&quot;</span><span class="p">,</span>
      <span class="s">&quot;filter&quot;</span><span class="p">:{</span>
        <span class="s">&quot;geom&quot;</span><span class="p">:[</span><span class="s">&quot;closed&quot;</span><span class="p">],</span>
        <span class="s">&quot;building&quot;</span><span class="p">:[</span>
          <span class="s">&quot;yes&quot;</span><span class="p">,</span><span class="s">&quot;residential&quot;</span><span class="p">,</span><span class="s">&quot;house&quot;</span><span class="p">,</span><span class="s">&quot;garage&quot;</span><span class="p">,</span><span class="s">&quot;detached&quot;</span><span class="p">,</span><span class="s">&quot;terrace&quot;</span><span class="p">,</span><span class="s">&quot;apartments&quot;</span><span class="p">,</span> <span class="s">&quot;hut&quot;</span><span class="p">,</span> <span class="s">&quot;industrial&quot;</span><span class="p">,</span> <span class="s">&quot;roof&quot;</span><span class="p">,</span> <span class="s">&quot;garages&quot;</span><span class="p">,</span>
          <span class="s">&quot;terrace&quot;</span><span class="p">,</span> <span class="s">&quot;farm_auxiliary&quot;</span><span class="p">,</span> <span class="s">&quot;commercial&quot;</span><span class="p">,</span> <span class="s">&quot;retail&quot;</span><span class="p">,</span> <span class="s">&quot;school&quot;</span><span class="p">,</span> <span class="s">&quot;church&quot;</span><span class="p">,</span> <span class="s">&quot;shed&quot;</span><span class="p">,</span> <span class="s">&quot;manufacture&quot;</span><span class="p">,</span> <span class="s">&quot;greenhouse&quot;</span><span class="p">,</span>
          <span class="s">&quot;farm&quot;</span><span class="p">,</span><span class="s">&quot;office&quot;</span><span class="p">,</span><span class="s">&quot;cabin&quot;</span><span class="p">,</span><span class="s">&quot;barn&quot;</span><span class="p">],</span>
        <span class="s">&quot;aeroway&quot;</span><span class="p">:[</span><span class="s">&quot;terminal&quot;</span><span class="p">]</span>
      <span class="p">},</span>
      <span class="s">&quot;fields&quot;</span><span class="p">:{</span>
        <span class="s">&quot;geom&quot;</span><span class="p">:{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;geom&quot;</span><span class="p">,</span><span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;POLYGON&quot;</span><span class="p">},</span>
        <span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;status&quot;</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;STRING&quot;</span><span class="p">},</span>
        <span class="s">&quot;building&quot;</span><span class="p">:{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;building&quot;</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;STRING&quot;</span><span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With that in place, and the coordinates for the Rosario city, lets populate the repo and tell GeoGig to create
the <tt class="docutils literal"><span class="pre">osm_roads</span></tt> and <tt class="docutils literal"><span class="pre">osm_buildings</span></tt> feature type trees using the mapping file.</p>
<div class="highlight-python"><div class="highlight"><pre>$ geogig osm download --mapping mappings.json --bbox -33.0183 -60.7246 -32.8684 -60.6096
Connecting to http://overpass-api.de/api/interpreter...
Importing into GeoGig repo...
79,770
80,568 entities processed in 13.86 s

Building trees for [node, osm_buildings, osm_roads, way]
Trees built in 438.6 ms
Staging features...
100%
Committing features...
100%
Processed entities: 80,568.
 Nodes: 65,808.
 Ways: 14,760
</pre></div>
</div>
<p>Verify the data is in there:</p>
<div class="highlight-python"><div class="highlight"><pre>$ gig log
Commit:  8affe7aff71fca408d8281cfca71243ef36178e9
Author:  John Doe &lt;John@example.com&gt;
Date:    (1 minutes ago) 2014-10-08 20:10:25 -0300
Subject: Updated OSM data
$ geogig ls-tree
osm_roads
osm_buildings
node
way
</pre></div>
</div>
<p>Now lets create a workspace in geoserver to hold our data store:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -d &quot;&lt;workspace&gt;&lt;name&gt;geogigtest&lt;/name&gt;&lt;/workspace&gt;&quot; http://localhost:8080/geoserver/rest/workspaces
&gt; POST /geoserver/rest/workspaces HTTP/1.1
&lt; HTTP/1.1 201 Created
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Beware of not calling your namespace <tt class="docutils literal"><span class="pre">geogig</span></tt> as it&#8217;s &#8220;local workspace catalog&#8221; entry point will conflict with the <tt class="docutils literal"><span class="pre">/geogig</span></tt> REST API entry point.</p>
</div>
<p>Create the GeoGig data store called <tt class="docutils literal"><span class="pre">rosario_osm</span></tt> inside that workspace. To do so, create a file named <tt class="docutils literal"><span class="pre">datastore.xml</span></tt> in the
current directory with the following content (note the value of the <tt class="docutils literal"><span class="pre">geogig_repository</span></tt> connection parameter is the repository directory):</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;dataStore&gt;
   &lt;name&gt;rosario_osm&lt;/name&gt;
   &lt;connectionParameters&gt;
      &lt;entry key=&quot;geogig_repository&quot;&gt;/data/repos/geoserver/rosario_osm&lt;/entry&gt;
   &lt;/connectionParameters&gt;
&lt;/dataStore&gt;
</pre></div>
</div>
<p>The run:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -T datastore.xml http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores
&lt; HTTP/1.1 201 Created
</pre></div>
</div>
<p>And verify the data store exists:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -XGET -H &quot;Accept: text/xml&quot; http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_osm
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;dataStore&gt;
  &lt;name&gt;rosario_osm&lt;/name&gt;
  &lt;type&gt;GeoGIG&lt;/type&gt;
  &lt;enabled&gt;true&lt;/enabled&gt;
  &lt;workspace&gt;
    &lt;name&gt;geogigtest&lt;/name&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/workspaces/geogigtest.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;/workspace&gt;
  &lt;connectionParameters&gt;
    &lt;entry key=&quot;geogig_repository&quot;&gt;6d62a0fe-1d98-42ac-a8ac-169dbc6e778a&lt;/entry&gt;
    &lt;entry key=&quot;resolver&quot;&gt;org.geogig.geoserver.config.GeoServerStoreRepositoryResolver&lt;/entry&gt;
    &lt;entry key=&quot;namespace&quot;&gt;http://geogigtest&lt;/entry&gt;
  &lt;/connectionParameters&gt;
  &lt;__default&gt;false&lt;/__default&gt;
  &lt;featureTypes&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_osm/featuretypes.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;/featureTypes&gt;
</pre></div>
</div>
<p><strong>Note</strong> that the GeoGig GeoServer plugin has replaced the value of the <tt class="docutils literal"><span class="pre">geogig_repository</span></tt> connection parameter by the unique identifier
of the internal object that represents the repository, and has added a <tt class="docutils literal"><span class="pre">resolver</span></tt> connection parameter, which is used to instruct the
GeoGig DataStore implementation how to resolve the repository location.</p>
<p>When working with the REST API, you can use one or the other format indistinctly. If you create a second data store for the same
repository using the repository directory as parameter instead of the repository id and the &#8220;resolver&#8221; parameter, the GeoGig plugin
will realize they&#8217;re the same repository and reuse the existing configuration, assigning the new data store the same repository id.</p>
<p>To verify so, lets create a branch in the repository and a new data store that uses that branch instead. To do so, copy the following
XML fragment to a file called <tt class="docutils literal"><span class="pre">datastore_branch.xml</span></tt>, that has a different name, an extra <tt class="docutils literal"><span class="pre">branch</span></tt> connection parameter, and the
same repository directory:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;dataStore&gt;
&lt;name&gt;rosario_experimental&lt;/name&gt;
&lt;connectionParameters&gt;
   &lt;entry key=&quot;geogig_repository&quot;&gt;/data/repos/geoserver/rosario_osm&lt;/entry&gt;
   &lt;entry key=&quot;branch&quot;&gt;experimental&lt;/entry&gt;
&lt;/connectionParameters&gt;
&lt;/dataStore&gt;
</pre></div>
</div>
<p>Then create the branch called <tt class="docutils literal"><span class="pre">experimental</span></tt> in the repository, call the GeoServer REST API to create the new data store, and
finally get the new repository information:</p>
<div class="highlight-python"><div class="highlight"><pre>$ geogig branch experimental
$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -T datastore_branch.xml http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores
&lt; HTTP/1.1 201 Created
$ curl -u admin:geoserver -XGET -H &quot;Accept: text/xml&quot; http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_experimental
&lt;dataStore&gt;
  &lt;name&gt;rosario_experimental&lt;/name&gt;
  &lt;type&gt;GeoGIG&lt;/type&gt;
  &lt;enabled&gt;true&lt;/enabled&gt;
  &lt;workspace&gt;
    &lt;name&gt;geogigtest&lt;/name&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/workspaces/geogigtest.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;/workspace&gt;
  &lt;connectionParameters&gt;
    &lt;entry key=&quot;geogig_repository&quot;&gt;6d62a0fe-1d98-42ac-a8ac-169dbc6e778a&lt;/entry&gt;
    &lt;entry key=&quot;branch&quot;&gt;experimental&lt;/entry&gt;
    &lt;entry key=&quot;resolver&quot;&gt;org.geogig.geoserver.config.GeoServerStoreRepositoryResolver&lt;/entry&gt;
    &lt;entry key=&quot;namespace&quot;&gt;http://geogigtest&lt;/entry&gt;
  &lt;/connectionParameters&gt;
  &lt;__default&gt;false&lt;/__default&gt;
  &lt;featureTypes&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_experimental/featuretypes.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;/featureTypes&gt;
&lt;/dataStore&gt;
</pre></div>
</div>
<p>You should note that the same repository identifier was assigned (in this case <strong>6d62a0fe-1d98-42ac-a8ac-169dbc6e778a</strong>).</p>
<p>Now you have two different data stores, served from the same geogig repository, at different branches. These two different branches may
have different feature type trees (i.e. &#8220;layers&#8221;) or different versions of them.</p>
<p>Lets revisit the initial query in this tutorial, and check the list of available repositories using GeoGig&#8217;s own REST API:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -H &quot;Accept:text/xml&quot; &quot;http://localhost:8080/geoserver/geogig&quot;
&lt; HTTP/1.1 200 OK
&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;
&lt;repositories&gt;
   &lt;repository&gt;
      &lt;id&gt;6d62a0fe-1d98-42ac-a8ac-169dbc6e778a&lt;/id&gt;
      &lt;name&gt;rosario_osm&lt;/name&gt;
      &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/geogig/6d62a0fe-1d98-42ac-a8ac-169dbc6e778a.xml&quot; type=&quot;application/xml&quot;/&gt;
   &lt;/repository&gt;
&lt;/repositories&gt;
$ curl -v -u admin:geoserver -H &quot;Accept:text/xml&quot; &quot;http://localhost:8080/geoserver/geogig/6d62a0fe-1d98-42ac-a8ac-169dbc6e778a.xml&quot;
&lt; HTTP/1.1 200 OK
&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;
&lt;repository&gt;
   &lt;id&gt;6d62a0fe-1d98-42ac-a8ac-169dbc6e778a&lt;/id&gt;
   &lt;name&gt;rosario_osm&lt;/name&gt;
   &lt;location&gt;/data/repos/geoserver/rosario_osm&lt;/location&gt;
&lt;/repository&gt;
</pre></div>
</div>
<p>Also make sure the repository contains the expected feature type trees using the <tt class="docutils literal"><span class="pre">ls-tree</span></tt> command:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -H &quot;Accept:text/xml&quot; &quot;http://localhost:8080/geoserver/geogig/6d62a0fe-1d98-42ac-a8ac-169dbc6e778a/ls-tree&quot;
&lt; HTTP/1.1 200 OK
&lt;response&gt;
   &lt;success&gt;true&lt;/success&gt;
   &lt;node&gt;&lt;path&gt;osm_roads&lt;/path&gt;&lt;/node&gt;
   &lt;node&gt;&lt;path&gt;osm_buildings&lt;/path&gt;&lt;/node&gt;
   &lt;node&gt;&lt;path&gt;node&lt;/path&gt;&lt;/node&gt;
   &lt;node&gt;&lt;path&gt;way&lt;/path&gt;&lt;/node&gt;
&lt;/response&gt;
</pre></div>
</div>
<p>Finally, lets create a GeoServer FeatureType and Layer for each of the <tt class="docutils literal"><span class="pre">osm_roads</span></tt> and <tt class="docutils literal"><span class="pre">osm_buildings</span></tt> feature type
trees:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -d &quot;&lt;featureType&gt;&lt;name&gt;osm_roads&lt;/name&gt;&lt;/featureType&gt;&quot; http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_osm/featuretypes
&lt; HTTP/1.1 201 Created
$ curl -v -u admin:geoserver -XPOST -H &quot;Content-type: text/xml&quot; -d &quot;&lt;featureType&gt;&lt;name&gt;osm_buildings&lt;/name&gt;&lt;/featureType&gt;&quot; http://localhost:8080/geoserver/rest/workspaces/geogigtest/datastores/rosario_osm/featuretypes
&lt; HTTP/1.1 201 Created
</pre></div>
</div>
<p>The above requests create the feature types, which automatically create a layer with default settings for each one:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -u admin:geoserver -XGET -H &quot;Accept: text/xml&quot; http://localhost:8080/geoserver/rest/layers
&lt;layers&gt;
  &lt;layer&gt;
    &lt;name&gt;osm_roads&lt;/name&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/layers/osm_roads.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;/layer&gt;
  &lt;layer&gt;
    &lt;name&gt;osm_buildings&lt;/name&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8080/geoserver/rest/layers/osm_buildings.xml&quot; type=&quot;application/xml&quot;/&gt;
   &lt;/layer&gt;
&lt;/layers&gt;
</pre></div>
</div>
<p>Changing the configuration of either the feature types or the layers is just a matter of following the regular GeoServer REST
API to do so.
See  <a class="reference external" href="http://docs.geoserver.org/stable/en/user/rest/api/featuretypes.html">Feature types</a> and <a class="reference external" href="http://docs.geoserver.org/stable/en/user/rest/api/layers.html">Layers</a>
in the GeoServer user manual for more information. The GeoServer <a class="reference external" href="http://docs.geoserver.org/stable/en/user/rest/examples/curl.html">cURL examples</a>
are also a good source of information.</p>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="geoserver_ui.html" title="previous chapter">GeoServer</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="osm.html" title="next chapter">Using GeoGig with OpenStreetMap data</a></div>
      </div>
      <p class="centered-text"><a href="#top"><img src="../_static/arrow_up.png" alt="back to top"/></a></p>
      </div><!-- /#content> -->
  <div id="sidebar" class="sidebar-offcanvas contrast col-sm-4 sidebar-offcanvas" id="sidebar" role="navigation">

    <div>
         <form id="quick-search" action="search.html" method="get" style="width: 100%;">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
          </fieldset>
        </form>


        <div class="btn-group-vertical" id="docs_toc">
          <button type="button" class="btn btn-default"><a href="/docs/">User Manual</a></button>
          <button type="button" class="btn btn-default"><a href="/technical/">Technical Manual</a></button>
          <button type="button" class="btn btn-default"><a href="/manpages/">Man Pages</a></button>
          <button type="button" class="btn btn-default"><a href="/workshop/">Workshop</a></button>
      </div>
      <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Web-API and GeoServer REST configuration</a><ul>
<li><a class="reference internal" href="#geogig-s-plugin-web-api">GeoGig&#8217;s plugin Web-API</a></li>
<li><a class="reference internal" href="#creating-a-geogig-datastore-with-rest">Creating a GeoGig DataStore with REST</a></li>
<li><a class="reference internal" href="#quick-example">Quick example:</a></li>
<li><a class="reference internal" href="#curl-tutorial">cURL tutorial</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section continue_reading">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="geoserver_ui.html" title="previous chapter">GeoServer</a></li>
            <li>Next: <a href="osm.html" title="next chapter">Using GeoGig with OpenStreetMap data</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../_sources/interaction/geoserver_web-api.txt">Show Source</a></li>
        </ul>
        </div>
        <div class="section">
          <h3>License</h3>
          <p>This project is licensed under the <a href="https://github.com/locationtech/geogig/blob/master/LICENSE.txt">Eclipse License</a>.</p>
        </div>

  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div>
</div>

</div><!-- /#main -->
    <footer>
      <div class="container">
        <div class="row">
          <div class=""><p class="repo-owner"><a href="https://github.com/locationtech/geogig">GeoGig</a> is maintained by <a href="https://github.com/boundlessgeo"><img src="../_static/Boundless_Logo.png" alt="Boundless"></a></p></div>
        </div>
      </div>
    </footer>


  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/jquery-migrate-min.js"></script>
  <script type="text/javascript" src="../_static/bootstrap.js" ></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" src="../searchindex.js"></script>
  <script>
      $(document).ready(function() {

      $('[data-toggle=offcanvas]').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
      $('.list-group-item').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
    });
  </script>
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3879903-19']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
  </script>
  </body>
</html>
