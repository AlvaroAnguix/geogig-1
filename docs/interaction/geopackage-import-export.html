<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1">
  
  <title>GeoPackage import and export Web-API &mdash; GeoGig 1.0-RC2 User Manual</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,800italic,300,700,600,800,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cantarell:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../_static/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />
  <!--[if IE]>
  <link rel="stylesheet" href="../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
   <link rel="stylesheet" href="../_static/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/offcanvas.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0-RC2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
      <link rel="top" title="GeoGig 1.0-RC2 User Manual" href="../index.html" />
      <link rel="up" title="Other ways to interact with GeoGig" href="index.html" />
      <link rel="prev" title="OpenStreetMap Web-Api Documentation" href="osm-web-api.html" />
</head>
<body class="interaction/geopackage-import-export">
    <div id="blacktop"></div>
    <header id="masthead">
      <div class="navbar">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://geogig.org"><h1>GeoGig</h1></a>
          </div>
          <div class="navbar-collapse collapse navbar-right">
            <ul class="nav navbar-nav">
              <li><a href="http://geogig.org/#install">Get Started</a></li>
              <li><a href="http://geogig.org/docs/index.html">Documentation</a></li>
              <li><a href="https://github.com/locationtech/geogig">On Github</a></li>
            </ul>
          </div><!--/.navbar-collapse -->
        </div>
      </div>
    </header>

    <section class="subheading hidden-xs">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <p class="byline">A Tool for Geospatial Data Management</p>
          </div>
        </div>
      </div>
    </section>
    <a name="top"></a>

 <div id="main">
    <div class="wrap selfclear">
      <div id="content">
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-right">
          <div class="col-md-8">
            <div class="row pull-right">
             <div class="visible-sm visible-xs" id="menu-btn">
                <button class="btn btn-blue btn-sm"type="button" data-toggle="offcanvas">
                  <span class="btn-text active">Menu &rarr;</span>
                  <span class="btn-back">&larr; Back</span>
                </button>
              </div>
            </div>
<ul id="breadcrumbs">
  
  <li><a href="../index.html">GeoGig 1.0-RC2 User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Other ways to interact with GeoGig</a> &raquo;</li>
  <li>GeoPackage import and export Web-API</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../genindex.html" title="General Index"
       accesskey="I">index</a></li>
  <li>
    <a href="osm-web-api.html" title="OpenStreetMap Web-Api Documentation"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="geopackage-import-and-export-web-api">
<h1>GeoPackage import and export Web-API<a class="headerlink" href="#geopackage-import-and-export-web-api" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://www.geopackage.org/">GeoPackage</a> is an open, standards-based, platform-independent, portable, self-describing, compact format for transferring geospatial information.</p>
<p>The GeoPackage import-export GeoGig Web-API allows for downloading a repository snapshot or a subset of it as a GeoPackage file, and for uploading a GeoPackage file and import its vector layers into the GeoGig repository.</p>
<div class="section" id="geopackage-export">
<h2>GeoPackage export<a class="headerlink" href="#geopackage-export" title="Permalink to this headline">¶</a></h2>
<p>Exports a repository snapshot or a subset of it as a GeoPackage file.</p>
<p>A repository snaphot is the data (layers and their features) addressable from a certain commit.</p>
<div class="highlight-python"><div class="highlight"><pre>GET /&lt;repo&gt;/export[.xml|.json]?format=gpkg[&amp;root=&lt;refspec&gt;][&amp;path=&lt;layerName&gt;[,&lt;layerName&gt;]+][&amp;bbox=&lt;boundingBox&gt;][&amp;interchange=&lt;true|false&gt;]
</pre></div>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>format:</strong>
Mandatory. Must be <tt class="docutils literal"><span class="pre">gpkg</span></tt> (case insensitive). Defines the output format of the export operation.</p>
<p><strong>root:</strong>
Optional. Defaults to <tt class="docutils literal"><span class="pre">HEAD</span></tt>. The ref spec that resolves to the root tree from
where to export data (e.g. <tt class="docutils literal"><span class="pre">HEAD</span></tt>, <tt class="docutils literal"><span class="pre">WORK_HEAD</span></tt>, a branch name like <tt class="docutils literal"><span class="pre">master</span></tt>,
<tt class="docutils literal"><span class="pre">refs/heads/master</span></tt>, a commit id, possibly abbreviated like <tt class="docutils literal"><span class="pre">50e295dd</span></tt>, a relative
refspec like <tt class="docutils literal"><span class="pre">HEAD~2</span></tt>, <tt class="docutils literal"><span class="pre">master^4</span></tt>, etc)</p>
<p><strong>path:</strong>
Optional. A comma separated list of layer names to export. Defaults to exporting all layers in the resolved root tree.</p>
<p><strong>bbox:</strong>
Optional. A bounding box filter. If present, only features matching the
indicated bounding box filter will be exported. Applies to all exported layers. Format is
<tt class="docutils literal"><span class="pre">minx,miny,maxx,maxy,&lt;SRS&gt;</span></tt>, where <tt class="docutils literal"><span class="pre">SRS</span></tt> is the EPSG code for the coordinates (e.g.
<tt class="docutils literal"><span class="pre">EPSG:4326</span></tt>, <tt class="docutils literal"><span class="pre">EPSG:26986</span></tt>, etc), always using &#8220;longitude first&#8221; axis order.</p>
<p><strong>interchange:</strong>
Optional. Boolean indicating whether to enable GeoGig&#8217;s interchange format extension for GeoPackage.
The &#8220;GeoGig GeoPackage Extention&#8221; is an extension to the geopackage format that (transparently) records all changes made
to vector layers in hidden audit tables that can then be used to replay those changes on top of the repository.</p>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="missing-format-argument">
<h4>Missing format argument:<a class="headerlink" href="#missing-format-argument" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v &quot;http://localhost:8182/export&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;response&gt;
  &lt;success&gt;false&lt;/success&gt;
  &lt;error&gt;output format not provided&lt;/error&gt;
&lt;/response&gt;
</pre></div>
</div>
</div>
<div class="section" id="bad-refspec">
<h4>Bad refspec:<a class="headerlink" href="#bad-refspec" title="Permalink to this headline">¶</a></h4>
<p>Note since the command is run asynchronously, you&#8217;ll notice the error once the async task status is polled:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v &quot;http://localhost:8182/export?format=GPKG&amp;root=nonExistingBranch&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;task&gt;
  &lt;id&gt;2&lt;/id&gt;
  &lt;status&gt;RUNNING&lt;/status&gt;
  &lt;description&gt;Export to Geopackage database&lt;/description&gt;
  &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/2.xml&quot; type=&quot;application/xml&quot;/&gt;
&lt;/task&gt;

$ curl -v &quot;http://localhost:8182/tasks/1.xml&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;task&gt;
  &lt;id&gt;2&lt;/id&gt;
  &lt;status&gt;FAILED&lt;/status&gt;
  &lt;description&gt;Export to Geopackage database&lt;/description&gt;
  &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/2.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;error&gt;
    &lt;message&gt;RefSpec doesn&#39;t resolve to a tree: &#39;nonExistingBranch&#39;&lt;/message&gt;
    &lt;stackTrace&gt;&lt;![CDATA[java.lang.IllegalArgumentException: RefSpec doesn&#39;t resolve to a tree: &#39;nonExistingBranch&#39;
        at com.google.common.base.Preconditions.checkArgument(Preconditions.java:145)
        at org.locationtech.geogig.geotools.plumbing.DataStoreExportOp.resolveExportLayerRefSpecs(DataStoreExportOp.java:178)
]]&gt;&lt;/stackTrace&gt;
  &lt;/error&gt;
&lt;/task&gt;
</pre></div>
</div>
</div>
<div class="section" id="export-all-layers-in-the-current-head">
<h4>Export all layers in the current HEAD:<a class="headerlink" href="#export-all-layers-in-the-current-head" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v &quot;http://localhost:8182/export?format=GPKG&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;task&gt;
  &lt;id&gt;3&lt;/id&gt;
  &lt;status&gt;RUNNING&lt;/status&gt;
  &lt;description&gt;Export to Geopackage database&lt;/description&gt;
  &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/3.xml&quot; type=&quot;application/xml&quot;/&gt;
&lt;/task&gt;
</pre></div>
</div>
<p>Poll task status until it&#8217;s FINISHED:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v &quot;http://localhost:8182/tasks/3.xml&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;task&gt;
  &lt;id&gt;3&lt;/id&gt;
  &lt;status&gt;RUNNING&lt;/status&gt;
  &lt;description&gt;Export to Geopackage database&lt;/description&gt;
  &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/3.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;progress&gt;
    &lt;task&gt;Exporting from d77a84bee98ae2972953308775c0b0f318f0df6d:ne_10m_roads to ne_10m_roads... &lt;/task&gt;
    &lt;amount&gt;99.29507&lt;/amount&gt;
  &lt;/progress&gt;
&lt;/task&gt;


$ curl -v &quot;http://localhost:8182/tasks/3.xml&quot; | xmllint --format -
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;task&gt;
  &lt;id&gt;3&lt;/id&gt;
  &lt;status&gt;FINISHED&lt;/status&gt;
  &lt;description&gt;Export to Geopackage database&lt;/description&gt;
  &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/3.xml&quot; type=&quot;application/xml&quot;/&gt;
  &lt;result&gt;
    &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/3/download&quot; type=&quot;application/octet-stream;type=geopackage&quot;/&gt;
  &lt;/result&gt;
&lt;/task&gt;
</pre></div>
</div>
<p>Note once the task is finished, the <cite>result</cite> element contains the download link for the generated geopackage file.</p>
<p>Finally, download the GeoPackage:</p>
<div class="highlight-python"><div class="highlight"><pre>$ curl -v &quot;http://localhost:8182/tasks/3/download&quot; &gt; all_layers_current_head.gpkg
&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/octet-stream;type=geopackage
&lt; Content-Length: 80854016
100 77.1M  100 77.1M    0     0   842M      0 --:--:-- --:--:-- --:--:--  847M
* Connection #0 to host localhost left intact
</pre></div>
</div>
<p>That <cite>curl</cite> command downloaded the geopackage to the <cite>all_layers_current_head.gpkg</cite> file.
Now you can open it, for example, in QGGIS:</p>
<div class="highlight-python"><div class="highlight"><pre>$ qgis all_layers_current_head.gpkg
</pre></div>
</div>
<div class="figure">
<img alt="../_images/qgis_exported_geopackage.png" src="../_images/qgis_exported_geopackage.png" />
</div>
</div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="osm-web-api.html" title="previous chapter">OpenStreetMap Web-Api Documentation</a></div>
      </div>
      <p class="centered-text"><a href="#top"><img src="../_static/arrow_up.png" alt="back to top"/></a></p>
      </div><!-- /#content> -->
  <div id="sidebar" class="sidebar-offcanvas contrast col-sm-4 sidebar-offcanvas" id="sidebar" role="navigation">

    <div>
         <form id="quick-search" action="search.html" method="get" style="width: 100%;">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
          </fieldset>
        </form>


        <div class="btn-group-vertical" id="docs_toc">
          <button type="button" class="btn btn-default"><a href="/docs/">User Manual</a></button>
          <button type="button" class="btn btn-default"><a href="/technical/">Technical Manual</a></button>
          <button type="button" class="btn btn-default"><a href="/manpages/">Man Pages</a></button>
          <button type="button" class="btn btn-default"><a href="/workshop/">Workshop</a></button>
      </div>
      <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">GeoPackage import and export Web-API</a><ul>
<li><a class="reference internal" href="#geopackage-export">GeoPackage export</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#missing-format-argument">Missing format argument:</a></li>
<li><a class="reference internal" href="#bad-refspec">Bad refspec:</a></li>
<li><a class="reference internal" href="#export-all-layers-in-the-current-head">Export all layers in the current HEAD:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section continue_reading">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="osm-web-api.html" title="previous chapter">OpenStreetMap Web-Api Documentation</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../_sources/interaction/geopackage-import-export.txt">Show Source</a></li>
        </ul>
        </div>
        <div class="section">
          <h3>License</h3>
          <p>This project is licensed under the <a href="https://github.com/locationtech/geogig/blob/master/LICENSE.txt">Eclipse License</a>.</p>
        </div>

  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div>
</div>

</div><!-- /#main -->
    <footer>
      <div class="container">
        <div class="row">
          <div class=""><p class="repo-owner"><a href="https://github.com/locationtech/geogig">GeoGig</a> is maintained by <a href="https://github.com/boundlessgeo"><img src="../_static/Boundless_Logo.png" alt="Boundless"></a></p></div>
        </div>
      </div>
    </footer>


  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/jquery-migrate-min.js"></script>
  <script type="text/javascript" src="../_static/bootstrap.js" ></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" src="../searchindex.js"></script>
  <script>
      $(document).ready(function() {

      $('[data-toggle=offcanvas]').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
      $('.list-group-item').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
    });
  </script>
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3879903-19']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
  </script>
  </body>
</html>
